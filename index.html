<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<title>Smart City Dashboard</title>
<script src="https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
* {
box-sizing: border-box;
}

html, body {
margin: 0;
padding: 0;
height: 100%;
font-family: 'Orbitron', sans-serif;
background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
color: #00ffff;
overflow: hidden;
}

.container {
display: flex;
height: 100vh;
}

.left-pane {
flex: 7.5;
position: relative;
background-color: #000;
border-right: 2px solid rgba(0, 255, 255, 0.2);
box-shadow: inset 0 0 30px #00eaff55;
}

.right-pane {
flex: 2;
padding: 18px;
background: radial-gradient(circle, #0a1e2f, #06121f);
overflow-y: auto;
color: #c5faff;
}

#skfb-frame {
width: 100%;
height: 100%;
border: none;
filter: drop-shadow(0 0 20px #00eaff);
}

.camera-section {
margin-bottom: 12px;
padding-bottom: 10px;
border-bottom: 1px dashed rgba(0, 255, 255, 0.1);
}

.camera-title {
font-size: 18px;
font-weight: bold;
color: #00ffff;
margin-bottom: 5px;
border-left: 4px solid #00eaff;
padding-left: 8px;
}

.camera-image img {
display: block; 
margin-left: auto; /
margin-right: auto;
width: 100%;
height: auto;
border-radius: 8px;
border: 1px solid #00eaff;
box-shadow: 0 0 12px #00eaff66;
margin-bottom: 8px;
transition: transform 0.3s ease;
}

.camera-image img:hover {
transform: scale(1.03);
}

.camera-detail {
font-size: 14px;
background-color: rgba(0, 255, 255, 0.05);
border-left: 3px solid #00ffff;
padding: 10px;
border-radius: 5px;
line-height: 1.4;
box-shadow: 0 0 8px #00c8ff44;
margin-bottom: 5px;
}

 .card {
      background: rgba(20, 20, 20, 0.6); /* ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ */
      backdrop-filter: blur(12px);       /* ‡πÄ‡∏ö‡∏•‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á ‡∏°‡∏±‡∏ß‡πÜ */
      -webkit-backdrop-filter: blur(12px);
      border-radius: 16px;               /* ‡∏°‡∏∏‡∏°‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô */
      border: 1px solid rgba(255, 255, 255, 0.08); /* ‡∏Ç‡∏≠‡∏ö‡πÇ‡∏õ‡∏£‡πà‡∏á‡∏ö‡∏≤‡∏á‡πÜ */
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);   /* ‡πÄ‡∏á‡∏≤‡∏ô‡∏∏‡πà‡∏°‡∏•‡∏∂‡∏Å */
      padding: 16px;
      color: #e0e0e0;                    /* ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏° */
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    /* ‡πÉ‡∏™‡πà effect ‡∏ï‡∏≠‡∏ô hover ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô */
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.6);
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      padding: 1px;
      border-radius: var(--radius);
      background: linear-gradient(145deg, #00ffff55, #00000022);
      -webkit-mask: 
        linear-gradient(#fff 0 0) content-box, 
        linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events: none;
    }

    h2, h3 {
      text-shadow: var(--neon);
      font-size: 18px;
    }

    .electrical-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 18px;             /* ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á */
      width: 100%;
      box-sizing: border-box;
    }

    .electrical-grid .metric {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 14px 8px;
      text-align: center;
      min-width: 100px;
      min-height: 80px; /* ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ */
      display: flex;
      flex-direction: column;
      justify-content: center;   /* ‚úÖ ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
      box-shadow: 0 0 10px #0ff4, inset 0 0 8px rgba(255, 255, 255, 0.1);
      transition: transform 0.2s ease;
    }
    .electrical-grid .metric:hover {
      transform: scale(1.03);
    }

    .electrical-grid .metric strong {
      font-size: 13px;               /* ‚úÖ ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î font ‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
      white-space: nowrap;           /* ‚úÖ ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏û‡∏±‡∏ö */
      overflow: hidden;
      text-overflow: ellipsis;
      display: block;
      margin-bottom: 6px;
      color: #0ff;
    }

    .electrical-grid .metric div {
      font-size: 20px;
      font-weight: 600;
      overflow-wrap: break-word;
      word-break: break-word;
      font-variant-numeric: tabular-nums;
    }

</style>
</head>
<body>
<div class="container">
<div class="left-pane">
<iframe id="skfb-frame" allow="autoplay; fullscreen; xr-spatial-tracking" allowfullscreen></iframe>
</div>

<div class="right-pane">
<div class="camera-section">
    
<div class="camera-title" id="cameraNameBox">üì∑ ‡∏£‡∏≠‡∏Å‡∏î Annotation ‡∏Å‡∏•‡πâ‡∏≠‡∏á...</div>
<div class="camera-image" id="infoBox">‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ</div>

      <div class="card">
        <h3>
          <svg width="20" height="20" fill="#0ff" viewBox="0 0 24 24">
            <path d="M2 4h20v2H2V4zm2 4h16v3l3 3v2H1v-2l3-3V8zm2 2v2h12v-2H6zm1 6h10v2H7v-2z"/>
          </svg> CCTV Security<br></br>
        </h3>
          <div class="electrical-grid">
            <div class="metric">
              <strong style="color: #0ff;">Offline</strong>
              <div id="infoBox2">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Intruder</strong>
              <div id="infoBox3">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Online</strong>
              <div id="infoBox4">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Total</strong>
              <div id="infoBox5">0</div>
            </div>
          </div>
      </div>

      <div class="card">
        <h3>
          <svg width="20" height="20" fill="#0ff" viewBox="0 0 24 24">
            <path d="M2 4h20v2H2V4zm2 4h16v3l3 3v2H1v-2l3-3V8zm2 2v2h12v-2H6zm1 6h10v2H7v-2z"/>
          </svg> CCTV Security<br></br>
        </h3>
          <div class="electrical-grid">
            <div class="metric">
              <strong style="color: #0ff;">Offline</strong>
              <div id="infoBox6">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Intruder</strong>
              <div id="infoBox7">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Online</strong>
              <div id="infoBox8">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Total</strong>
              <div id="infoBox9">0</div>
            </div>
          </div>
      </div>
      

      <div class="card">
        <h3>
          <svg width="20" height="20" fill="#0ff" viewBox="0 0 24 24">
            <path d="M2 4h20v2H2V4zm2 4h16v3l3 3v2H1v-2l3-3V8zm2 2v2h12v-2H6zm1 6h10v2H7v-2z"/>
          </svg> CCTV Security<br></br>
        </h3>
          <div class="electrical-grid">
            <div class="metric">
              <strong style="color: #0ff;">Offline</strong>
              <div id="infoBox10">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Intruder</strong>
              <div id="infoBox11">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Online</strong>
              <div id="infoBox12">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Total</strong>
              <div id="infoBox13">0</div>
            </div>
          </div>
      </div>
      

      <div class="card">
        <h3>
          <svg width="20" height="20" fill="#0ff" viewBox="0 0 24 24">
            <path d="M2 4h20v2H2V4zm2 4h16v3l3 3v2H1v-2l3-3V8zm2 2v2h12v-2H6zm1 6h10v2H7v-2z"/>
          </svg> CCTV Security<br></br>
        </h3>
          <div class="electrical-grid">
            <div class="metric">
              <strong style="color: #0ff;">Offline</strong>
              <div id="infoBox14">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Intruder</strong>
              <div id="infoBox15">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Online</strong>
              <div id="infoBox16">0</div>
            </div>
            <div class="metric">
              <strong style="color: #0ff;">Total</strong>
              <div id="infoBox17">0</div>
            </div>
          </div>
      </div>
</div>
</div>
</div>

<script>
const iframe = document.getElementById('skfb-frame');
const client = new Sketchfab(iframe);
let CameraName = '';

function getTextFromGoogleSheet(cameraId) {
const sheetID = "1pG8ldAgtHsOzlVxjITuBp2XCS77Sdk15fvmR-YU-MDg";
const sheetName = "Data";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

fetch(url)
.then(res => res.text())
.then(data => {
const jsonData = JSON.parse(data.substr(47).slice(0, -2));
const rows = jsonData.table.rows;

for (let i = 0; i < rows.length; i++) {
const row = rows[i].c;
if (row[0] && row[0].v === cameraId) {
// ‡∏Å‡∏•‡πâ‡∏≠‡∏á 1
const img1 = row[2]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

const text1 = row[3]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text2 = row[4]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text3 = row[5]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text4 = row[6]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

const text5 = row[7]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text6 = row[8]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text7 = row[9]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text8 = row[10]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

const text9 = row[11]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text10 = row[12]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text11 = row[13]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text12 = row[14]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

const text13 = row[15]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text14 = row[16]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text15 = row[17]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
const text16 = row[18]?.v || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

document.getElementById("infoBox").innerHTML = `<img src="${img1}" alt="‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á">`;
document.getElementById("infoBox2").innerText = text1;
document.getElementById("infoBox3").innerText = text2;
document.getElementById("infoBox4").innerText = text3;
document.getElementById("infoBox5").innerText = text4;

document.getElementById("infoBox6").innerText = text5;
document.getElementById("infoBox7").innerText = text6;
document.getElementById("infoBox8").innerText = text7;
document.getElementById("infoBox9").innerText = text8;

document.getElementById("infoBox10").innerText = text9;
document.getElementById("infoBox11").innerText = text10;
document.getElementById("infoBox12").innerText = text11;
document.getElementById("infoBox13").innerText = text12;

document.getElementById("infoBox14").innerText = text13;
document.getElementById("infoBox15").innerText = text14;
document.getElementById("infoBox16").innerText = text15;
document.getElementById("infoBox17").innerText = text16;

break;
}
}
})
.catch(err => console.error("‚ùå Error loading Google Sheet:", err));
}

client.init('7adcd28260174cf58dd2672e1e189426', {
success: function (api) {
api.start();
api.addEventListener('viewerready', function () {
api.addEventListener('annotationFocus', function (index) {
api.getAnnotation(index, function (err, annotation) {
if (!err && annotation?.name) {
CameraName = annotation.name;
document.getElementById('cameraNameBox').innerText = '‡∏ä‡∏±‡πâ‡∏ô ' + CameraName;
getTextFromGoogleSheet(CameraName);
}
});
});
});
},
error: function () {
console.error('‚ùå ‡πÇ‡∏´‡∏•‡∏î Sketchfab API ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ');
}
});
</script>
</body>
</html>


